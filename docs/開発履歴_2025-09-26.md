# LIFE-X B2B ã‚µã‚¤ãƒˆé–‹ç™ºå±¥æ­´

**ä½œæˆæ—¥**: 2025å¹´9æœˆ26æ—¥
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: LIFE-X B2Bå‘ã‘Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Supabase (PostgreSQL)
**ãƒ‡ãƒ—ãƒ­ã‚¤**: Vercel

---

## ğŸ“Š ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

LIFE-X B2Bå‘ã‘ã®6ã¤ã®ä¸»è¦ãƒšãƒ¼ã‚¸ã‚’æŒã¤Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®Supabaseçµ±åˆã‚’å®Ÿæ–½ã€‚
LocalStorageãƒ™ãƒ¼ã‚¹ã‹ã‚‰Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ç§»è¡Œã‚’è¡Œã„ã€ç®¡ç†ç”»é¢ã®CRUDæ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚

### ä¸»è¦ãƒšãƒ¼ã‚¸
1. **é–“å–ãƒãƒˆãƒªãƒƒã‚¯ã‚¹** - ãƒ—ãƒ©ãƒ³æ¤œç´¢ãƒ»é¸æŠã‚·ã‚¹ãƒ†ãƒ 
2. **ãƒ‡ã‚¶ã‚¤ãƒ³ã‚»ãƒ¬ã‚¯ãƒˆ** - ãƒ‡ã‚¶ã‚¤ãƒ³ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ—ãƒ©ãƒ³è¡¨ç¤º
3. **ãƒ—ãƒ©ãƒ³ä¸€è¦§** - å…¨ãƒ—ãƒ©ãƒ³ç®¡ç†
4. **ãƒ«ãƒ¼ãƒ«ä¸€è¦§** - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ç®¡ç†
5. **ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰** - è³‡æ–™ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç®¡ç†
6. **ã‚ˆãã‚ã‚‹è³ªå•** - FAQç®¡ç†

---

## ğŸ”§ å®Ÿè£…ä½œæ¥­å±¥æ­´

### 1. Supabaseæ¥ç¶šè¨­å®š
**ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**:
- `test-supabase-connection.js` - æ¥ç¶šãƒ†ã‚¹ãƒˆç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- `.env` - ç’°å¢ƒå¤‰æ•°è¨­å®š

**ä¸»ãªä¿®æ­£**:
- CommonJS (`require`) ã‹ã‚‰ ES Modules (`import`) ã¸ã®å¤‰æ›
- CDNçµŒç”±ã§ã®Supabase Clientã‚¤ãƒ³ãƒãƒ¼ãƒˆ

---

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `supabase-migration.sql`

**ä½œæˆã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«**:
```sql
-- FAQé–¢é€£
- faqs (è³ªå•ãƒ»å›ç­”)
- faq_categories (ã‚«ãƒ†ã‚´ãƒª)
- faq_feedback (ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯)

-- ãƒ—ãƒ©ãƒ³é–¢é€£
- plans (ãƒ—ãƒ©ãƒ³æƒ…å ±)
- plan_images (ç”»åƒ)
- plan_files (ãƒ•ã‚¡ã‚¤ãƒ«)

-- ãƒ«ãƒ¼ãƒ«é–¢é€£
- rules (ãƒ«ãƒ¼ãƒ«)
- rule_categories (ã‚«ãƒ†ã‚´ãƒª)

-- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–¢é€£
- downloads (ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰è³‡æ–™)
- download_categories (ã‚«ãƒ†ã‚´ãƒª)

-- ãã®ä»–
- design_categories (ãƒ‡ã‚¶ã‚¤ãƒ³ã‚«ãƒ†ã‚´ãƒª)
- matrix_settings (ãƒãƒˆãƒªãƒƒã‚¯ã‚¹è¨­å®š)
- matrix_cells (ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ã‚»ãƒ«)
- user_profiles (ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«)
- activity_logs (ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°)
- system_settings (ã‚·ã‚¹ãƒ†ãƒ è¨­å®š)
```

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š**:
- Row Level Security (RLS) ãƒãƒªã‚·ãƒ¼
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
- ãƒˆãƒªã‚¬ãƒ¼è¨­å®š

---

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çµ±åˆ
**ä½œæˆã—ãŸJavaScriptãƒ•ã‚¡ã‚¤ãƒ«**:

#### `src/js/supabase-client.js`
- Supabaseæ¥ç¶šç®¡ç†
- èªè¨¼å‡¦ç†
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

#### `src/js/supabase-api.js`
- å„ãƒ†ãƒ¼ãƒ–ãƒ«ã®CRUDæ“ä½œ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ‡ãƒ¼ã‚¿å¤‰æ›å‡¦ç†

#### `src/js/supabase-integration.js`
- ã‚°ãƒ­ãƒ¼ãƒãƒ«APIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- LocalStorage/Supabaseãƒ–ãƒªãƒƒã‚¸æ©Ÿèƒ½
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®äº’æ›æ€§ä¿æŒ

**æ›´æ–°ã—ãŸHTMLãƒ•ã‚¡ã‚¤ãƒ«**:
- `admin-faq.html` - FAQç®¡ç†ç”»é¢
- `admin-plans.html` - ãƒ—ãƒ©ãƒ³ç®¡ç†ç”»é¢
- `admin-rules.html` - ãƒ«ãƒ¼ãƒ«ç®¡ç†ç”»é¢
- `admin-downloads.html` - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç®¡ç†ç”»é¢

---

### 4. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `supabase-test-data.sql`

**æŠ•å…¥ãƒ‡ãƒ¼ã‚¿**:
- FAQã‚«ãƒ†ã‚´ãƒª: 5ä»¶
- FAQ: 10ä»¶
- ãƒ«ãƒ¼ãƒ«ã‚«ãƒ†ã‚´ãƒª: 4ä»¶
- ãƒ«ãƒ¼ãƒ«: 10ä»¶
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚«ãƒ†ã‚´ãƒª: 5ä»¶
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰: 10ä»¶
- ãƒ—ãƒ©ãƒ³: 10ä»¶

---

### 5. å•é¡Œå¯¾å¿œã¨ä¿®æ­£

#### A. èªè¨¼ã‚¨ãƒ©ãƒ¼å¯¾å¿œ
**å•é¡Œ**: `authManager is not defined`
**è§£æ±º**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè£…ã‚’è¿½åŠ 
```javascript
if (!window.authManager) {
    window.authManager = {
        requireAuth: () => true,
        getCurrentUser: () => ({ email: 'test@example.com' })
    };
}
```

#### B. MIMEã‚¿ã‚¤ãƒ—ã‚¨ãƒ©ãƒ¼å¯¾å¿œ
**å•é¡Œ**: JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ãŒ `text/plain` ã¨ã—ã¦é…ä¿¡
**è§£æ±º**: `vercel.json` ã« Content-Type ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ 
```json
{
  "source": "/js/(.*)",
  "headers": [{
    "key": "Content-Type",
    "value": "application/javascript; charset=utf-8"
  }]
}
```

#### C. RLSãƒãƒªã‚·ãƒ¼é•åå¯¾å¿œ
**å•é¡Œ**: `new row violates row-level security policy`
**è§£æ±º**:
1. `supabase-fix-rls.sql` ä½œæˆï¼ˆé–‹ç™ºç’°å¢ƒç”¨ï¼‰
2. `execute-in-supabase.sql` ä½œæˆï¼ˆå®Ÿè¡Œæ‰‹é †ä»˜ãï¼‰
3. å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®RLSã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–

#### D. ã‚«ãƒ†ã‚´ãƒªIDãƒãƒƒãƒ”ãƒ³ã‚°å•é¡Œ
**å•é¡Œ**: ã‚«ãƒ†ã‚´ãƒªåï¼ˆæ–‡å­—åˆ—ï¼‰ã¨category_idï¼ˆUUIDï¼‰ã®ä¸ä¸€è‡´
**è§£æ±º**: `admin-faq.html` ã«ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ã‚’è¿½åŠ 
```javascript
const categoryMap = {
    'ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³': '11111111-1111-1111-1111-111111111111',
    'ãƒ—ãƒ©ãƒ³ãƒ»ä¾¡æ ¼': '22222222-2222-2222-2222-222222222222',
    'æŠ€è¡“ãƒ»ä»•æ§˜': '33333333-3333-3333-3333-333333333333',
    'ã‚µãƒãƒ¼ãƒˆ': '44444444-4444-4444-4444-444444444444',
    'ãã®ä»–': '55555555-5555-5555-5555-555555555555'
};
```

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
LIFE-X-site/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ supabase-client.js      # Supabaseæ¥ç¶š
â”‚   â”‚   â”œâ”€â”€ supabase-api.js         # APIå±¤
â”‚   â”‚   â””â”€â”€ supabase-integration.js # çµ±åˆå±¤
â”‚   â”œâ”€â”€ admin-faq.html              # FAQç®¡ç†
â”‚   â”œâ”€â”€ admin-plans.html            # ãƒ—ãƒ©ãƒ³ç®¡ç†
â”‚   â”œâ”€â”€ admin-rules.html            # ãƒ«ãƒ¼ãƒ«ç®¡ç†
â”‚   â””â”€â”€ admin-downloads.html        # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç®¡ç†
â”œâ”€â”€ supabase-migration.sql          # DBã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ supabase-test-data.sql          # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ supabase-fix-rls.sql            # RLSä¿®æ­£
â”œâ”€â”€ execute-in-supabase.sql         # å®Ÿè¡Œç”¨SQL
â”œâ”€â”€ vercel.json                     # Vercelè¨­å®š
â””â”€â”€ .env                            # ç’°å¢ƒå¤‰æ•°
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±

**Vercel URL**: https://life-x-bto-b.vercel.app/

**ä¸»è¦ãƒšãƒ¼ã‚¸URL**:
- ç®¡ç†ç”»é¢: https://life-x-bto-b.vercel.app/admin
- FAQç®¡ç†: https://life-x-bto-b.vercel.app/admin-faq
- ãƒ—ãƒ©ãƒ³ç®¡ç†: https://life-x-bto-b.vercel.app/admin-plans
- ãƒ«ãƒ¼ãƒ«ç®¡ç†: https://life-x-bto-b.vercel.app/admin-rules
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç®¡ç†: https://life-x-bto-b.vercel.app/admin-downloads

---

## ğŸ” Supabaseè¨­å®šæ‰‹é †

### 1. RLSç„¡åŠ¹åŒ–ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
1. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹
2. SQL Editorã‚’é–‹ã
3. `execute-in-supabase.sql` ã®å†…å®¹ã‚’å®Ÿè¡Œ
4. å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®RLSãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹

### 2. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥
1. SQL Editorã‚’é–‹ã
2. `supabase-test-data.sql` ã®å†…å®¹ã‚’å®Ÿè¡Œ
3. å„ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒæŠ•å…¥ã•ã‚Œã‚‹

---

## ğŸ“ Git ã‚³ãƒŸãƒƒãƒˆå±¥æ­´

1. **åˆæœŸSupabaseæ¥ç¶š**: Supabaseæ¥ç¶šãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ä½œæˆ
2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ**: å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
3. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çµ±åˆ**: APIå±¤ã¨HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±åˆ
4. **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ**: SQLãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
5. **RLSä¿®æ­£**: RLSç„¡åŠ¹åŒ–ã¨ã‚«ãƒ†ã‚´ãƒªIDãƒãƒƒãƒ”ãƒ³ã‚°ä¿®æ­£

---

## âš ï¸ æ³¨æ„äº‹é …

### é–‹ç™ºç’°å¢ƒ
- RLSã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãªã—ï¼‰
- ãƒ†ã‚¹ãƒˆç”¨ã®å›ºå®šUUIDä½¿ç”¨ä¸­
- èªè¨¼ã¯ç°¡æ˜“å®Ÿè£…

### æœ¬ç•ªç’°å¢ƒã¸ã®ç§»è¡Œæ™‚
1. é©åˆ‡ãªRLSãƒãƒªã‚·ãƒ¼ã‚’è¨­å®š
2. èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…
3. ã‚«ãƒ†ã‚´ãƒªã®å‹•çš„ç®¡ç†
4. ç’°å¢ƒå¤‰æ•°ã®æœ¬ç•ªç”¨è¨­å®š
5. ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®å®Ÿè£…

---

## ğŸ”„ ä»Šå¾Œã®ä½œæ¥­

### å„ªå…ˆåº¦ï¼šé«˜
- [ ] èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®æœ¬å®Ÿè£…
- [ ] RLSãƒãƒªã‚·ãƒ¼ã®æœ¬ç•ªç”¨è¨­å®š
- [ ] ã‚«ãƒ†ã‚´ãƒªã®å‹•çš„ç®¡ç†æ©Ÿèƒ½

### å„ªå…ˆåº¦ï¼šä¸­
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- [ ] ç”»åƒç®¡ç†æ©Ÿèƒ½
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½

### å„ªå…ˆåº¦ï¼šä½
- [ ] ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°ã®å¯è¦–åŒ–
- [ ] çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] å¤šè¨€èªå¯¾å¿œ

---

## ğŸ“ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: HTML, Alpine.js, Tailwind CSS
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Supabase (PostgreSQL)
- **ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: Vercel
- **èªè¨¼**: Supabase Authï¼ˆæœªå®Ÿè£…ï¼‰
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Supabase Storageï¼ˆéƒ¨åˆ†å®Ÿè£…ï¼‰

---

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- **GitHub**: https://github.com/nishinocat/LIFE-X-BtoB
- **Vercel**: https://life-x-bto-b.vercel.app/
- **Supabase**: https://tkemcbxqbrfqgmyswkjg.supabase.co/

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´9æœˆ26æ—¥